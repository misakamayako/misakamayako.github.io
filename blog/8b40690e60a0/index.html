<!DOCTYPE html><html lang="zh-hans" class="h-full w-full m-0"> <head><meta charset="utf-8"><link rel="icon" type="image/jepg" href="/favicon.jpg"><meta name="viewport" content="width=device-width"><meta name="google-site-verification" content="-RgOsAO7rMTpJ8vNk8-ILdAA8VmiTEUc9HiUVVTKeEs"><meta name="generator" content="Astro v5.12.0"><title>âœ¨å¾¡å‚ç½‘ç»œ-BroadcastChannel API æ¦‚è¿°âœ¨</title><link rel="stylesheet" href="/_astro/index.DbbbHqKR.css">
<style>/*! tailwindcss v4.0.9 | MIT License | https://tailwindcss.com */
.okTgGW_footer{font-size:var(--text-sm,.875rem);line-height:var(--tw-leading,var(--text-sm--line-height,calc(1.25/.875)));color:var(--color-stone-400,#a6a09b);text-align:center;padding-block:calc(var(--spacing,.25rem)*4);border-top-color:var(--color-zinc-50,#fafafa);border-top-style:var(--tw-border-style);background-color:var(--color-slate-900,#0f172b);border-top-width:2px;width:100%;position:relative}@supports (color:color(display-p3 0 0 0)){.okTgGW_footer{color:var(--color-stone-400,color(display-p3 .647628 .627105 .61098));border-top-color:var(--color-zinc-50,color(display-p3 .980256 .980256 .980256));background-color:var(--color-slate-900,color(display-p3 .0639692 .0891152 .163036))}}@supports (color:lab(0% 0 0)){.okTgGW_footer{color:var(--color-stone-400,lab(66.2166% 1.88047 3.20326));border-top-color:var(--color-zinc-50,lab(98.26% -.0000298023 0));background-color:var(--color-slate-900,lab(7.78673% 1.82345 -15.0537))}}.okTgGW_footer a{text-decoration-line:underline}@property --tw-border-style{syntax:"*";inherits:false;initial-value:solid}
/*! tailwindcss v4.0.9 | MIT License | https://tailwindcss.com */
.q0UmqG_menu{height:calc(var(--spacing,.25rem)*16);padding-right:calc(var(--spacing,.25rem)*16);border-bottom-color:var(--color-zinc-50,#fafafa);border-bottom-style:var(--tw-border-style);text-align:right;border-bottom-width:2px}@supports (color:color(display-p3 0 0 0)){.q0UmqG_menu{border-bottom-color:var(--color-zinc-50,color(display-p3 .980256 .980256 .980256))}}@supports (color:lab(0% 0 0)){.q0UmqG_menu{border-bottom-color:var(--color-zinc-50,lab(98.26% -.0000298023 0))}}.q0UmqG_menu a{padding-inline:calc(var(--spacing,.25rem)*2);padding-block:calc(var(--spacing,.25rem)*2);font-size:var(--text-xl,1.25rem);line-height:var(--tw-leading,var(--text-xl--line-height,calc(1.75/1.25)));color:var(--color-zinc-50,#fafafa);margin-top:calc(var(--spacing,.25rem)*2.5);display:inline-block}@supports (color:color(display-p3 0 0 0)){.q0UmqG_menu a{color:var(--color-zinc-50,color(display-p3 .980256 .980256 .980256))}}@supports (color:lab(0% 0 0)){.q0UmqG_menu a{color:var(--color-zinc-50,lab(98.26% -.0000298023 0))}}@media (hover:hover){.q0UmqG_menu a:hover{--tw-translate-y:calc(var(--spacing,.25rem)*-.5);translate:var(--tw-translate-x)var(--tw-translate-y);color:var(--color-sky-500,#00a5ef)}@supports (color:color(display-p3 0 0 0)){.q0UmqG_menu a:hover{color:var(--color-sky-500,color(display-p3 .219113 .639027 .931479))}}@supports (color:lab(0% 0 0)){.q0UmqG_menu a:hover{color:var(--color-sky-500,lab(63.3038% -18.433 -51.0407))}}}.q0UmqG_menu a{transition-property:color,background-color,border-color,outline-color,text-decoration-color,fill,stroke,--tw-gradient-from,--tw-gradient-via,--tw-gradient-to;transition-timing-function:var(--tw-ease,var(--default-transition-timing-function,cubic-bezier(.4,0,.2,1)));transition-duration:var(--tw-duration,var(--default-transition-duration,.15s));transition-property:transform,translate,scale,rotate;transition-timing-function:var(--tw-ease,var(--default-transition-timing-function,cubic-bezier(.4,0,.2,1)));transition-duration:var(--tw-duration,var(--default-transition-duration,.15s))}.q0UmqG_navLink{padding-inline:calc(var(--spacing,.25rem)*2);padding-block:calc(var(--spacing,.25rem)*2);font-size:var(--text-xl,1.25rem);line-height:var(--tw-leading,var(--text-xl--line-height,calc(1.75/1.25)));color:var(--color-zinc-50,#fafafa);margin-top:calc(var(--spacing,.25rem)*2.5);display:inline-block}@supports (color:color(display-p3 0 0 0)){.q0UmqG_navLink{color:var(--color-zinc-50,color(display-p3 .980256 .980256 .980256))}}@supports (color:lab(0% 0 0)){.q0UmqG_navLink{color:var(--color-zinc-50,lab(98.26% -.0000298023 0))}}@media (hover:hover){.q0UmqG_navLink:hover{color:var(--color-sky-500,#00a5ef)}@supports (color:color(display-p3 0 0 0)){.q0UmqG_navLink:hover{color:var(--color-sky-500,color(display-p3 .219113 .639027 .931479))}}@supports (color:lab(0% 0 0)){.q0UmqG_navLink:hover{color:var(--color-sky-500,lab(63.3038% -18.433 -51.0407))}}}.q0UmqG_navLink{transition:color .4s}.q0UmqG_avatar{float:right;border-radius:.25rem;display:inline-block;overflow:hidden}@property --tw-border-style{syntax:"*";inherits:false;initial-value:solid}@property --tw-translate-x{syntax:"*";inherits:false;initial-value:0}@property --tw-translate-y{syntax:"*";inherits:false;initial-value:0}@property --tw-translate-z{syntax:"*";inherits:false;initial-value:0}
</style>
<link rel="stylesheet" href="/_astro/_slug_.DDqNTp95.css"><script type="module" src="/_astro/page.V2R8AmkL.js"></script></head> <body class="w-full h-full flex flex-col">  <div class="bg-slate-800 h-screen flex flex-col"> <div class="bg-slate-700 w-full"> <div class="q0UmqG_avatar"> <img src="/favicon.jpg" width="64" height="64" alt=""> </div> <nav class="q0UmqG_menu"> <a href="/" class="q0UmqG_navLink">home</a> <a href="/blog/" class="q0UmqG_navLink">blog</a> <a href="/utils/" class="q0UmqG_navLink">utils</a> <a href="/dream-map/" class="inline-block">dream map</a> <a href="/album/" class="q0UmqG_navLink">album</a> <a href="/about-me/" class="q0UmqG_navLink">about me</a> </nav> </div> <div class="flex p-4 grow flex-row h-full overflow-hidden"> <aside class="w-1/4 ml-4 md:block min-w-[200px]"> <div class="sticky top-4 space-y-6"> <div class="bg-slate-700 p-4 rounded-lg"> <img src="/avatar.jpg" class="w-16 h-16 rounded-full mx-auto"> <p class="text-white text-center mt-2">ä½œè€…ï¼šmisakamayako</p>  <p class="text-white text-center mt-2">å‘å¸ƒæ—¶é—´ï¼š2025/05/20</p> </div> <div class="bg-slate-700 p-4 rounded-lg"> <h3 class="text-emerald-400 mb-2">ç®€ä»‹</h3> <p class="text-white font-light mb-2">æœ¬æ–‡è¯¦ç»†ä»‹ç»äº† BroadcastChannel API çš„ç”¨æ³•ã€ç‰¹æ€§ã€æµè§ˆå™¨å…¼å®¹æ€§åŠä¸å…¶ä»–å‰ç«¯é€šä¿¡æ–¹å¼çš„å¯¹æ¯”ï¼Œå¸®åŠ©å¼€å‘è€…ç†è§£å¦‚ä½•åœ¨åŒæºå¤šé¡µé¢ç¯å¢ƒä¸­é«˜æ•ˆå®ç°æ¶ˆæ¯å¹¿æ’­ã€‚</p> </div> <!-- 2. æ–‡ç« ç›®å½• --> <!--<div class="bg-slate-700 p-4 rounded-lg">--> <!--    <h3 class="text-emerald-400 mb-2">æœ¬æ–‡ç›®å½•</h3>--> <!--    &lt;!&ndash;<TOC client:load /> &ndash;&gt;--> <!--</div>--> <!-- 3. éšæœºæ–‡ç«  --> <div class="bg-slate-700 p-4 rounded-lg"> <h3 class="text-emerald-400 mb-2">éšä¾¿çœ‹çœ‹</h3> <div class="flex flex-wrap gap-2"> <a class="px-3 py-1 bg-slate-600 rounded-full text-sm text-white hover:bg-emerald-500 transition" href="/blog/2ed8a0ceb014/"> WebGPU vs CPUï¼šå¹¶è¡Œè®¡ç®—æ€§èƒ½å®æµ‹å¯¹æ¯” </a><a class="px-3 py-1 bg-slate-600 rounded-full text-sm text-white hover:bg-emerald-500 transition" href="/blog/7631b3f6f737/"> axiosåœ¨nodeç¯å¢ƒä¸­ä½¿ç”¨æ—¶ä¸èƒ½æ­£ç¡®è®¿é—®æœ¬åœ°æœåŠ¡çš„é—®é¢˜ </a><a class="px-3 py-1 bg-slate-600 rounded-full text-sm text-white hover:bg-emerald-500 transition" href="/blog/2b6de1fc1e65/"> åŸºäºKotlinåç¨‹çš„é«˜æ•ˆå¼‚æ­¥æ–‡ä»¶ä¸Šä¼ æœåŠ¡è®¾è®¡ä¸å®ç° </a> </div> </div> </div> </aside> <main class="grow h-full overflow-auto w-3/4 px-8"> <article class="text-white mb-2 prose lg:prose-xl prose-stone
                 prose-headings:text-white prose-strong:text-white prose-code:text-white
                 prose-a:text-violet-200 prose-blockquote:text-stone-100">  <header> <h1>BroadcastChannel API æ¦‚è¿°</h1> </header> <p><strong>BroadcastChannel API</strong> æ˜¯ä¸€é¡¹æµè§ˆå™¨ Web APIï¼Œå…è®¸åŒä¸€æ¥æºï¼ˆoriginï¼‰ä¸‹çš„ä¸åŒæµè§ˆä¸Šä¸‹æ–‡ï¼ˆå¦‚å¤šä¸ªæ ‡ç­¾é¡µã€iframeã€<code>window.open</code> æ‰“å¼€çš„çª—å£ï¼Œç”šè‡³åŒæºçš„ Workerï¼‰ä¹‹é—´è¿›è¡Œæ¶ˆæ¯å¹¿æ’­é€šä¿¡ã€‚æ‰€æœ‰åŠ å…¥åŒä¸€é¢‘é“ï¼ˆchannelï¼‰åç§°çš„ä¸Šä¸‹æ–‡éƒ½èƒ½å½¼æ­¤æ”¶å‘æ¶ˆæ¯ã€‚</p>
<h2 id="åˆ›å»ºé¢‘é“ä¸ç›‘å¬æ¶ˆæ¯">åˆ›å»ºé¢‘é“ä¸ç›‘å¬æ¶ˆæ¯</h2>
<ul>
<li>ä½¿ç”¨ <code>new BroadcastChannel(name)</code> åˆ›å»ºæˆ–åŠ å…¥ä¸€ä¸ªå¹¿æ’­é¢‘é“ã€‚å…¶ä¸­ <code>name</code> ä¸ºé¢‘é“æ ‡è¯†ï¼Œå­—ç¬¦ä¸²å½¢å¼ã€‚ä¾‹å¦‚ï¼š</li>
</ul>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="javascript"><code><span class="line"><span style="color:#F97583">const</span><span style="color:#79B8FF"> channel</span><span style="color:#F97583"> =</span><span style="color:#F97583"> new</span><span style="color:#B392F0"> BroadcastChannel</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">'my_channel'</span><span style="color:#E1E4E8">);</span></span></code></pre>
<p>åªè¦å­˜åœ¨è‡³å°‘ä¸€ä¸ªä¸Šä¸‹æ–‡ä½¿ç”¨è¯¥åç§°åˆ›å»ºé¢‘é“ï¼Œåº•å±‚é€šé“å³è¢«æ‰“å¼€ã€‚</p>
<ul>
<li>åœ¨é¢‘é“å¯¹è±¡ä¸Šï¼Œå¯ä»¥ç”¨ <code>onmessage</code> æˆ– <code>addEventListener('message', handler)</code> ç›‘å¬æ¶ˆæ¯äº‹ä»¶ã€‚ä¾‹å¦‚ï¼š</li>
</ul>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="javascript"><code><span class="line"><span style="color:#E1E4E8">channel.</span><span style="color:#B392F0">onmessage</span><span style="color:#F97583"> =</span><span style="color:#FFAB70"> event</span><span style="color:#F97583"> =></span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#E1E4E8">  console.</span><span style="color:#B392F0">log</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">'æ”¶åˆ°æ¶ˆæ¯ï¼š'</span><span style="color:#E1E4E8">, event.data);</span></span>
<span class="line"><span style="color:#E1E4E8">};</span></span></code></pre>
<p>å½“å…¶ä»–åŒåé¢‘é“è°ƒç”¨ <code>postMessage()</code> å‘é€æ¶ˆæ¯æ—¶ï¼Œæ‰€æœ‰ç›‘å¬è¯¥é¢‘é“çš„ä¸Šä¸‹æ–‡ï¼ˆåŒ…æ‹¬æœ¬ä¸Šä¸‹æ–‡è‡ªèº«ï¼‰éƒ½ä¼šè§¦å‘ <code>message</code> äº‹ä»¶ã€‚</p>
<ul>
<li>è‹¥è¦é€€å‡ºé¢‘é“ï¼Œè°ƒç”¨ <code>channel.close()</code>ã€‚è¯¥æ–¹æ³•ä¼šâ€œç»ˆæ­¢ä¸åº•å±‚é¢‘é“çš„è¿æ¥ï¼Œä»è€Œå…è®¸å¯¹å¯¹è±¡è¿›è¡Œåƒåœ¾å›æ”¶â€ã€‚å…³é—­é¢‘é“åï¼Œå½“å‰ä¸Šä¸‹æ–‡ä¸å†æ¥æ”¶è¯¥é¢‘é“çš„æ–°æ¶ˆæ¯ã€‚</li>
</ul>
<h2 id="å‘é€æ¶ˆæ¯">å‘é€æ¶ˆæ¯</h2>
<ul>
<li>å‘é¢‘é“å¹¿æ’­æ¶ˆæ¯åªéœ€è°ƒç”¨ <code>postMessage(data)</code>ï¼š</li>
</ul>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="javascript"><code><span class="line"><span style="color:#E1E4E8">channel.</span><span style="color:#B392F0">postMessage</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">'è¿™æ˜¯ä¸€æ¡æµ‹è¯•æ¶ˆæ¯'</span><span style="color:#E1E4E8">);</span></span></code></pre>
<p>æ¶ˆæ¯å¯ä¸ºä»»æ„ç±»å‹çš„æ•°æ®ï¼ˆéµå¾ª<a href="https://developer.mozilla.org/zh-CN/docs/Web/API/Web_Workers_API/Structured_clone_algorithm">ç»“æ„åŒ–å…‹éš†ç®—æ³•</a>ï¼‰ï¼ŒåŒ…æ‹¬å¯¹è±¡ã€æ•°ç»„ã€Blobã€Fileã€ArrayBuffer ç­‰ã€‚å‘é€ç«¯æ— éœ€æŒ‡å®šç›®æ ‡ï¼Œæ¶ˆæ¯ä¼šè‡ªåŠ¨å‘é€ç»™æ‰€æœ‰ç›‘å¬è¯¥é¢‘é“çš„ä¸Šä¸‹æ–‡ã€‚</p>
<ul>
<li>æ¥æ”¶ç«¯é€šè¿‡ <code>message</code> äº‹ä»¶å¯¹è±¡çš„ <code>event.data</code> å±æ€§è·å–æ¶ˆæ¯å†…å®¹ï¼Œä¾‹å¦‚ï¼š</li>
</ul>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="javascript"><code><span class="line"><span style="color:#E1E4E8">channel.</span><span style="color:#B392F0">onmessage</span><span style="color:#F97583"> =</span><span style="color:#FFAB70"> event</span><span style="color:#F97583"> =></span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#E1E4E8">  console.</span><span style="color:#B392F0">log</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">'æ¥æ”¶åˆ°ï¼š'</span><span style="color:#E1E4E8">, event.data);</span></span>
<span class="line"><span style="color:#E1E4E8">};</span></span></code></pre>
<ul>
<li><strong>æ³¨æ„</strong>ï¼šæ¶ˆæ¯å†…å®¹é€šè¿‡æµè§ˆå™¨å†…éƒ¨çš„ç»“æ„åŒ–å…‹éš†ç®—æ³•ä¼ è¾“ï¼Œå› æ­¤å‡½æ•°ã€Symbol ç­‰ä¸å¯å…‹éš†ç±»å‹ä¼šè¢«ä¸¢å¼ƒã€‚å‘é€å¤§å‹å¤æ‚å¯¹è±¡ä¼šæ¶ˆè€—æ›´å¤šèµ„æºï¼Œå¯èƒ½ä¼šå½±å“æ€§èƒ½ã€‚</li>
</ul>
<h2 id="ç¤ºä¾‹æ¼”ç¤º">ç¤ºä¾‹æ¼”ç¤º</h2>
<p>ä¸‹é¢ç»™å‡ºä¸€ä¸ªç®€å•ç¤ºä¾‹ï¼šå‡è®¾åœ¨ä¸¤ä¸ªåŒæºé¡µé¢ï¼ˆæˆ–çª—å£ï¼‰ä¸­åˆ†åˆ«è¿è¡Œä»¥ä¸‹è„šæœ¬ï¼Œå®ƒä»¬éƒ½è®¢é˜…äº†é¢‘é“ <code>"demo_channel"</code>ã€‚</p>
<ul>
<li><strong>é¡µé¢ A è„šæœ¬ï¼š</strong></li>
</ul>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="javascript"><code><span class="line"><span style="color:#F97583">const</span><span style="color:#79B8FF"> bcA</span><span style="color:#F97583"> =</span><span style="color:#F97583"> new</span><span style="color:#B392F0"> BroadcastChannel</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">'demo_channel'</span><span style="color:#E1E4E8">);</span></span>
<span class="line"><span style="color:#E1E4E8">bcA.</span><span style="color:#B392F0">onmessage</span><span style="color:#F97583"> =</span><span style="color:#FFAB70"> e</span><span style="color:#F97583"> =></span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#E1E4E8">  console.</span><span style="color:#B392F0">log</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">'é¡µé¢ A æ”¶åˆ°ï¼š'</span><span style="color:#E1E4E8">, e.data);</span></span>
<span class="line"><span style="color:#E1E4E8">};</span></span>
<span class="line"><span style="color:#6A737D">// é¡µé¢ A ä¸»åŠ¨å‘é€æ¶ˆæ¯</span></span>
<span class="line"><span style="color:#E1E4E8">bcA.</span><span style="color:#B392F0">postMessage</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">'ä½ å¥½ï¼Œé¡µé¢ Bï¼'</span><span style="color:#E1E4E8">);</span></span></code></pre>
<ul>
<li><strong>é¡µé¢ B è„šæœ¬ï¼š</strong></li>
</ul>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="javascript"><code><span class="line"><span style="color:#F97583">const</span><span style="color:#79B8FF"> bcB</span><span style="color:#F97583"> =</span><span style="color:#F97583"> new</span><span style="color:#B392F0"> BroadcastChannel</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">'demo_channel'</span><span style="color:#E1E4E8">);</span></span>
<span class="line"><span style="color:#E1E4E8">bcB.</span><span style="color:#B392F0">onmessage</span><span style="color:#F97583"> =</span><span style="color:#FFAB70"> e</span><span style="color:#F97583"> =></span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#E1E4E8">  console.</span><span style="color:#B392F0">log</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">'é¡µé¢ B æ”¶åˆ°ï¼š'</span><span style="color:#E1E4E8">, e.data);</span></span>
<span class="line"><span style="color:#E1E4E8">};</span></span>
<span class="line"><span style="color:#6A737D">// é¡µé¢ B å‘é€æ¶ˆæ¯</span></span>
<span class="line"><span style="color:#E1E4E8">bcB.</span><span style="color:#B392F0">postMessage</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">'é¡µé¢ Aï¼Œä½ å¥½ï¼'</span><span style="color:#E1E4E8">);</span></span></code></pre>
<p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œé¡µé¢ A å‘é€çš„æ¶ˆæ¯ä¼šè¢«é¡µé¢ B æ¥æ”¶ï¼ŒåŒæ ·é¡µé¢ B çš„æ¶ˆæ¯ä¼šè¢«é¡µé¢ A æ¥æ”¶ã€‚å¼€å‘è€…åªéœ€ä¿è¯åˆ›å»ºäº†åŒåçš„ <code>BroadcastChannel</code> å®ä¾‹ï¼Œå¹¶è®¾ç½®å¥½ <code>onmessage</code> å¤„ç†å™¨ï¼Œå³å¯å®ç°å¤šé¡µé—´åŒå‘é€šä¿¡ã€‚</p>
<h2 id="å…¼å®¹æ€§ä¸æµè§ˆå™¨æ”¯æŒ">å…¼å®¹æ€§ä¸æµè§ˆå™¨æ”¯æŒ</h2>
<p>BroadcastChannel API è‡ª Chrome 54ã€Firefox 38ã€Opera 41 å¼€å§‹æ”¯æŒã€‚Chromeï¼ˆåŠChromium Edgeï¼‰ã€Firefoxã€Opera å‡åœ¨å…¶ç°ä»£ç‰ˆæœ¬ä¸­æ”¯æŒæ­¤ APIï¼Œè€Œ Safari åœ¨ 15.4+ï¼ˆiOS Safari åŒç‰ˆæœ¬ï¼‰å¼€å§‹æ”¯æŒã€‚ä¸‹è¡¨ä¸ºä¸»è¦æµè§ˆå™¨æ”¯æŒæƒ…å†µå‚è€ƒï¼š</p>
<ul>
<li><strong>Chrome / Chromium Edge</strong>ï¼š54 åŠä»¥ä¸Šç‰ˆæœ¬æ”¯æŒã€‚</li>
<li><strong>Firefox</strong>ï¼š38 åŠä»¥ä¸Šç‰ˆæœ¬æ”¯æŒã€‚</li>
<li><strong>Opera</strong>ï¼š41 åŠä»¥ä¸Šç‰ˆæœ¬æ”¯æŒã€‚</li>
<li><strong>Safari / iOS Safari</strong>ï¼š15.4 åŠä»¥ä¸Šç‰ˆæœ¬æ”¯æŒã€‚</li>
<li><strong>IEã€æ—§ç‰ˆ Safari/Android æµè§ˆå™¨</strong>ï¼šä¸æ”¯æŒã€‚</li>
</ul>
<p><strong>ä½¿ç”¨å»ºè®®ï¼š</strong> åœ¨ä½¿ç”¨å‰å¯é€šè¿‡ <code>if ('BroadcastChannel' in window)</code> è¿›è¡Œç‰¹æ€§æ£€æµ‹ã€‚å¯¹äºä¸æ”¯æŒçš„ç¯å¢ƒï¼Œå¯è€ƒè™‘é€€å›åˆ° <code>localStorage+storage</code> æˆ–å…¶ä»–æœºåˆ¶æ–¹æ¡ˆã€‚</p>
<h2 id="é™åˆ¶ä¸æ³¨æ„äº‹é¡¹">é™åˆ¶ä¸æ³¨æ„äº‹é¡¹</h2>
<ul>
<li><strong>åŒæºé™åˆ¶</strong>ï¼šBroadcastChannel åªèƒ½åœ¨â€œåŒæºâ€ä¸Šä¸‹æ–‡é—´é€šä¿¡ã€‚å…·ä½“è¦æ±‚æ˜¯åè®®ã€åŸŸåå’Œç«¯å£å‡ç›¸åŒã€‚è·¨åŸŸé¡µé¢æ— æ³•é€šè¿‡ BroadcastChannel ç›´æ¥é€šä¿¡ã€‚</li>
<li><strong>é¡µé¢å…³é—­</strong>ï¼šè°ƒç”¨ <code>close()</code> æˆ–é¡µé¢å¸è½½æ—¶ï¼Œå½“å‰ä¸Šä¸‹æ–‡ä¼šæ–­å¼€é¢‘é“è¿æ¥ã€‚ä¸€æ—¦å…³é—­ï¼Œå½“å‰é¡µå°±ä¸å†æ¥æ”¶è¯¥é¢‘é“çš„åç»­æ¶ˆæ¯ï¼Œä¹Ÿä¸ä¼šè§¦å‘äº‹ä»¶ã€‚å…¶å®ƒé¡µé¢ç»§ç»­å¹¿æ’­æ—¶ï¼Œå³ä½¿ä½¿ç”¨<code>service worker</code>ï¼Œå·²å…³é—­é¡µé¢æ— æ³•è·å¾—è¿™äº›æ¶ˆæ¯ã€‚</li>
<li><strong>æ€§èƒ½ä¸æ¶ˆæ¯å¤§å°</strong>ï¼šå¹¿æ’­æ¶ˆæ¯é€šè¿‡ç»“æ„åŒ–å…‹éš†ä¼ è¾“ï¼Œæ”¯æŒå¤æ‚æ•°æ®ç»“æ„ã€‚ä¸ <code>localStorage</code> æ–¹æ³•ä¸åŒï¼ŒBroadcastChannel ä¸å—æµè§ˆå™¨çš„æ•°æ®å¤§å°é™åˆ¶ã€‚ä¸è¿‡ï¼Œè¿‡å¤§çš„æ¶ˆæ¯ä»ä¼šå ç”¨è¾ƒå¤šèµ„æºï¼Œå¯èƒ½å¯¼è‡´é€šä¿¡å»¶è¿Ÿæˆ–å¤±è´¥ã€‚æ ¹æ®æµ‹è¯•ï¼Œç®€å•æ¶ˆæ¯çš„å¹¿æ’­å»¶è¿Ÿä¸€èˆ¬åœ¨ 1â€“2 æ¯«ç§’å·¦å³ï¼Œæ€§èƒ½å¼€é”€å¾ˆä½ã€‚ä½†åœ¨é«˜é¢‘ç‡æˆ–è¶…å¤§æ¶ˆæ¯åœºæ™¯ä¸‹ï¼Œä»éœ€è°¨æ…è®¾è®¡ä»¥é¿å…æ€§èƒ½ç“¶é¢ˆã€‚</li>
</ul>
<h2 id="ä¸å…¶ä»–é€šä¿¡æœºåˆ¶çš„å¯¹æ¯”">ä¸å…¶ä»–é€šä¿¡æœºåˆ¶çš„å¯¹æ¯”</h2>
<ul>
<li><strong>BroadcastChannel vs LocalStorage+storage äº‹ä»¶</strong>ï¼šä¼ ç»Ÿè·¨æ ‡ç­¾é¡µé€šä¿¡å¸¸ç”¨ <code>localStorage</code> å†™å…¥ + <code>storage</code> äº‹ä»¶ç›‘å¬çš„æ–¹å¼ï¼Œä½†è¯¥æ–¹æ³•åªèƒ½å‘é€å­—ç¬¦ä¸²ï¼ˆéœ€è¦æ‰‹åŠ¨åºåˆ—åŒ–ï¼‰ã€å­˜åœ¨æµè§ˆå™¨é™åˆ¶çš„å­˜å‚¨ä¸Šé™ï¼Œå¹¶ä¸”å­˜å–æ˜¯åŒæ­¥æ“ä½œï¼Œæœ‰æ—¶æ•ˆç‡è¾ƒä½ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼ŒBroadcastChannel API ä¸éœ€è¦è¯»å†™ç£ç›˜ï¼Œå…¨ç¨‹åœ¨å†…å­˜ä¸­å¹¿æ’­ï¼Œæ”¯æŒä»»æ„å¯å…‹éš†å¯¹è±¡ï¼Œæ²¡æœ‰å¤§å°é™åˆ¶ï¼Œå®æ—¶æ€§ä¹Ÿæ›´å¥½ï¼ˆæ— éœ€è½®è¯¢æˆ–é¢‘ç¹ I/Oï¼‰ã€‚</li>
<li><strong>BroadcastChannel vs postMessage</strong>ï¼š<code>window.postMessage</code> å…è®¸è·¨æºé€šä¿¡ï¼Œä½†éœ€è¦æŒæœ‰ç›®æ ‡çª—å£çš„å¼•ç”¨å¹¶æŒ‡å®šç›®æ ‡ originï¼Œä½¿ç”¨è¾ƒå¤æ‚ã€‚è€Œ BroadcastChannel åˆ™æ— éœ€å¼•ç”¨ç›®æ ‡çª—å£ï¼Œåªè¦åœ¨å„è‡ªé¡µé¢åˆ›å»ºåŒåé¢‘é“å³å¯ï¼Œä¸”åŒæºä¿è¯äº†æ¶ˆæ¯å®‰å…¨æ€§ï¼Œæ— éœ€é¢å¤–æ ¡éªŒæ¥æºã€‚ç®€å•åœºæ™¯ä¸‹ï¼ŒBroadcastChannel çš„ç”¨æ³•æ›´ç›´æ¥ã€‚ä½†å¦‚æœéœ€è¦å’Œä¸åŒ origin çš„é¡µé¢é€šä¿¡ï¼Œå°±åªèƒ½ä½¿ç”¨ <code>postMessage</code>ã€‚</li>
<li><strong>BroadcastChannel vs SharedWorker</strong>ï¼šSharedWorker å…è®¸å¤šä¸ªåŒæºé¡µé¢å…±äº«ä¸€ä¸ªåå°è„šæœ¬å®ä¾‹ï¼Œé€‚åˆéœ€è¦é›†ä¸­çŠ¶æ€ç®¡ç†ã€é”æœºåˆ¶æˆ–å…±äº« WebSocket è¿æ¥çš„å¤æ‚åœºæ™¯ã€‚è€Œ BroadcastChannel æ˜¯è½»é‡çº§çš„å¹¿æ’­æœºåˆ¶ï¼Œæ›´é€‚åˆç®€å•çš„äº‹ä»¶é€šçŸ¥æˆ–çŠ¶æ€åŒæ­¥ä»»åŠ¡ã€‚ä¾‹å¦‚åŒæ­¥ UI æ“ä½œæˆ–å¹¿æ’­é€šçŸ¥æ—¶ç”¨ BroadcastChannel æ›´ç®€ä¾¿ï¼›è€Œéœ€è¦åœ¨å¤šä¸ªé¡µé¢é—´ç»´æŠ¤æŒä¹…ä¸€è‡´çŠ¶æ€ï¼ŒSharedWorker å¯èƒ½æ›´åˆé€‚ã€‚</li>
<li><strong>BroadcastChannel vs MessageChannel</strong>ï¼šMessageChannel æä¾›ä¸¤ä¸ªç«¯å£çš„ä¸€å¯¹ä¸€é€šä¿¡ç®¡é“ï¼ˆé€‚ç”¨äºéœ€è¦ç²¾ç¡®æ§åˆ¶åŒå‘é€šä¿¡çš„åœºæ™¯ï¼‰ï¼Œè€Œ BroadcastChannel æ˜¯ä¸€å¯¹å¤šå¹¿æ’­æ¨¡å‹ã€‚å¦‚æœåªåœ¨ä¸¤ä¸ªçª—å£é—´é€šä¿¡ï¼ŒäºŒè€…çš†å¯é€‰æ‹©ï¼›ä½† BroadcastChannel å¯è‡ªåŠ¨å¹¿æ’­ç»™æ‰€æœ‰è®¢é˜…è€…ï¼Œä½¿ç”¨æ›´ç®€å•ã€‚</li>
</ul>
<p>æ€»çš„æ¥è¯´ï¼ŒBroadcastChannel API ä»¥å…¶ä½¿ç”¨æ–¹ä¾¿ã€ä¸€å¯¹å¤šå¹¿æ’­å’Œæ”¯æŒå¤šç§æ•°æ®ç±»å‹ç­‰ä¼˜ç‚¹ï¼Œæˆä¸ºåŒæºå¤šé¡µé¢å®æ—¶é€šä¿¡çš„ç†æƒ³æ–¹æ¡ˆã€‚ä½†éœ€æ³¨æ„å…¼å®¹æ€§å’ŒåŒæºé™åˆ¶ï¼Œåœ¨å®é™…å¼€å‘ä¸­åˆç†é€‰æ‹©é€šä¿¡æ–¹å¼ã€‚</p>  </article> <div class="tags"> <div class="_tailmateTag_u5zwa_5"> <a href="/blog/tag/BroadcastChannel/">BroadcastChannel</a> </div><div class="_tailmateTag_u5zwa_5"> <a href="/blog/tag/å‰ç«¯é€šä¿¡/">å‰ç«¯é€šä¿¡</a> </div><div class="_tailmateTag_u5zwa_5"> <a href="/blog/tag/Web API/">Web API</a> </div><div class="_tailmateTag_u5zwa_5"> <a href="/blog/tag/å¤šæ ‡ç­¾é¡µé€šä¿¡/">å¤šæ ‡ç­¾é¡µé€šä¿¡</a> </div> </div> </main> </div> <div class="okTgGW_footer"> <p>Supported and developed by&nbsp;
<a href="https://github.com/misakamayako/" target="_blank" rel="noreferrer">misaka mayako</a> </p> <p>
Tech with <a href="https://astro.build/" target="_blank" rel="noreferrer">astro</a>,&nbsp;
<a href="https://tailwindcss.com/" target="_blank" rel="noreferrer">tailwindcss</a>,&nbsp;
        and <a href="https://pm2.keymetrics.io/" target="_blank" rel="noreferrer">pm2</a>,&nbsp;
</p> <p> feed back via <a href="mailto:misakamayaco@qq.com" target="_blank" rel="noreferrer">ğŸ“«</a></p> <a rel="license noreferrer" href="https://creativecommons.org/licenses/by-sa/4.0/" target="_blank" class="absolute right-6 bottom-6"> <img alt="çŸ¥è¯†å…±äº«è®¸å¯åè®®" class="inlin-block border-0" src="/cc4.0.png"> </a> </div> </div> <script type="module" is:global>
        document.addEventListener('DOMContentLoaded', () => {
            document.querySelectorAll('pre').forEach((block) => {
                const button = document.createElement('button')
                button.innerText = 'å¤åˆ¶'
                button.className =
                    'absolute top-2 right-2 bg-slate-800 text-white px-2 py-1 rounded text-sm opacity-50 hover:opacity-100 transition cursor-pointer'
                button.addEventListener('click', () => {
                    const code = block.querySelector('code')
                    if (code) {
                        navigator.clipboard.writeText(code.innerText).then(() => {
                            button.innerText = 'å·²å¤åˆ¶ï¼'
                            setTimeout(() => (button.innerText = 'å¤åˆ¶'), 1000)
                        })
                    }
                })
                block.classList.add('relative')
                block.appendChild(button)
            })
        })
    </script>  </body></html>