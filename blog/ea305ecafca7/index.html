<!DOCTYPE html><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css" integrity="sha512-fHwaWebuwA7NSF5Qg/af4UeDx9XqUpYpOGgubo3yWu+b2IQR4UeQwbb42Ti7gVAjNtVoI/I9TEoYeu9omwcC6g==" crossorigin="anonymous"><html lang="zh-hans" class="h-full w-full m-0"> <head><meta charset="utf-8"><link rel="icon" type="image/jepg" href="/favicon.jpg"><meta name="viewport" content="width=device-width"><meta name="google-site-verification" content="-RgOsAO7rMTpJ8vNk8-ILdAA8VmiTEUc9HiUVVTKeEs"><meta name="generator" content="Astro v5.17.2"><title>âœ¨å¾¡å‚ç½‘ç»œ-è®© Feature åƒç¬¬ä¸‰æ–¹åº“ä¸€æ ·è¢«ä½¿ç”¨ï¼šAPI ä¸ Internal çš„è¾¹ç•Œè®¾è®¡âœ¨</title><link rel="stylesheet" href="/_astro/index.C6IHRFDG.css">
<style>/*! tailwindcss v4.1.18 | MIT License | https://tailwindcss.com */
@layer properties{@supports (((-webkit-hyphens:none)) and (not (margin-trim:inline))) or ((-moz-orient:inline) and (not (color:rgb(from red r g b)))){*,:before,:after,::backdrop{--tw-border-style:solid}}}.okTgGW_footer{font-size:var(--text-sm,.875rem);line-height:var(--tw-leading,var(--text-sm--line-height,calc(1.25/.875)));color:var(--color-stone-400,#a6a09b);text-align:center;padding-block:calc(var(--spacing,.25rem)*4);border-top-color:var(--color-zinc-50,#fafafa);border-top-style:var(--tw-border-style);background-color:var(--color-slate-900,#0f172b);border-top-width:2px;width:100%;position:relative}@supports (color:color(display-p3 0 0 0)){.okTgGW_footer{color:var(--color-stone-400,color(display-p3 .647628 .627105 .61098));border-top-color:var(--color-zinc-50,color(display-p3 .980256 .980256 .980256));background-color:var(--color-slate-900,color(display-p3 .0639692 .0891152 .163036))}}@supports (color:lab(0% 0 0)){.okTgGW_footer{color:var(--color-stone-400,lab(66.2166% 1.88044 3.20326));border-top-color:var(--color-zinc-50,lab(98.26% 0 0));background-color:var(--color-slate-900,lab(7.78673% 1.82345 -15.0537))}}.okTgGW_footer a{text-decoration-line:underline}@property --tw-border-style{syntax:"*";inherits:false;initial-value:solid}
/*! tailwindcss v4.1.18 | MIT License | https://tailwindcss.com */
@layer properties{@supports (((-webkit-hyphens:none)) and (not (margin-trim:inline))) or ((-moz-orient:inline) and (not (color:rgb(from red r g b)))){*,:before,:after,::backdrop{--tw-border-style:solid;--tw-translate-x:0;--tw-translate-y:0;--tw-translate-z:0}}}.q0UmqG_menu{height:calc(var(--spacing,.25rem)*16);padding-right:calc(var(--spacing,.25rem)*16);border-bottom-color:var(--color-zinc-50,#fafafa);border-bottom-style:var(--tw-border-style);text-align:right;border-bottom-width:2px}@supports (color:color(display-p3 0 0 0)){.q0UmqG_menu{border-bottom-color:var(--color-zinc-50,color(display-p3 .980256 .980256 .980256))}}@supports (color:lab(0% 0 0)){.q0UmqG_menu{border-bottom-color:var(--color-zinc-50,lab(98.26% 0 0))}}.q0UmqG_menu a{padding-inline:calc(var(--spacing,.25rem)*2);padding-block:calc(var(--spacing,.25rem)*2);font-size:var(--text-xl,1.25rem);line-height:var(--tw-leading,var(--text-xl--line-height,calc(1.75/1.25)));color:var(--color-zinc-50,#fafafa);margin-top:calc(var(--spacing,.25rem)*2.5);display:inline-block}@supports (color:color(display-p3 0 0 0)){.q0UmqG_menu a{color:var(--color-zinc-50,color(display-p3 .980256 .980256 .980256))}}@supports (color:lab(0% 0 0)){.q0UmqG_menu a{color:var(--color-zinc-50,lab(98.26% 0 0))}}@media (hover:hover){.q0UmqG_menu a:hover{--tw-translate-y:calc(var(--spacing,.25rem)*-.5);translate:var(--tw-translate-x)var(--tw-translate-y);color:var(--color-sky-500,#00a5ef)}@supports (color:color(display-p3 0 0 0)){.q0UmqG_menu a:hover{color:var(--color-sky-500,color(display-p3 .219113 .639027 .931479))}}@supports (color:lab(0% 0 0)){.q0UmqG_menu a:hover{color:var(--color-sky-500,lab(63.3038% -18.433 -51.0407))}}}.q0UmqG_menu a{transition-property:transform,translate,scale,rotate;transition-timing-function:var(--tw-ease,var(--default-transition-timing-function,cubic-bezier(.4,0,.2,1)));transition-duration:var(--tw-duration,var(--default-transition-duration,.15s))}.q0UmqG_navLink{padding-inline:calc(var(--spacing,.25rem)*2);padding-block:calc(var(--spacing,.25rem)*2);font-size:var(--text-xl,1.25rem);line-height:var(--tw-leading,var(--text-xl--line-height,calc(1.75/1.25)));color:var(--color-zinc-50,#fafafa);margin-top:calc(var(--spacing,.25rem)*2.5);display:inline-block}@supports (color:color(display-p3 0 0 0)){.q0UmqG_navLink{color:var(--color-zinc-50,color(display-p3 .980256 .980256 .980256))}}@supports (color:lab(0% 0 0)){.q0UmqG_navLink{color:var(--color-zinc-50,lab(98.26% 0 0))}}@media (hover:hover){.q0UmqG_navLink:hover{color:var(--color-sky-500,#00a5ef)}@supports (color:color(display-p3 0 0 0)){.q0UmqG_navLink:hover{color:var(--color-sky-500,color(display-p3 .219113 .639027 .931479))}}@supports (color:lab(0% 0 0)){.q0UmqG_navLink:hover{color:var(--color-sky-500,lab(63.3038% -18.433 -51.0407))}}}.q0UmqG_navLink{transition:color .4s}.q0UmqG_avatar{float:right;border-radius:.25rem;display:inline-block;overflow:hidden}@property --tw-border-style{syntax:"*";inherits:false;initial-value:solid}@property --tw-translate-x{syntax:"*";inherits:false;initial-value:0}@property --tw-translate-y{syntax:"*";inherits:false;initial-value:0}@property --tw-translate-z{syntax:"*";inherits:false;initial-value:0}
</style>
<link rel="stylesheet" href="/_astro/_slug_.aUcrWOZv.css"><script type="module" src="/_astro/page.D1uwR3nK.js"></script></head> <body class="w-full h-full flex flex-col"> <div class="bg-slate-800 h-screen flex flex-col"><div class="bg-slate-700 w-full"> <div class="q0UmqG_avatar"> <img src="/favicon.jpg" width="64" height="64" alt=""> </div> <nav class="q0UmqG_menu"> <a href="/" class="q0UmqG_navLink">home</a> <a href="/blog/" class="q0UmqG_navLink">blog</a> <a href="/utils/" class="q0UmqG_navLink">utils</a> <a href="/dream-map/" class="inline-block">dream map</a> <a href="/album/" class="q0UmqG_navLink">album</a> <a href="/about-me/" class="q0UmqG_navLink">about me</a> </nav> </div><div class="flex p-4 grow flex-row h-full overflow-hidden"><aside class="w-1/4 ml-4 md:block min-w-[200px] overflow-auto pr-2"><div class="sticky top-4 space-y-6"><div class="bg-slate-700 p-4 rounded-lg"><img src="/avatar.jpg" class="w-16 h-16 rounded-full mx-auto"><p class="text-white text-center mt-2">ä½œè€…ï¼šmisakamayako</p><p class="text-white text-center mt-2">å‘å¸ƒæ—¶é—´ï¼š2026/01/11</p></div><div class="bg-slate-700 p-4 rounded-lg"><h3 class="text-emerald-400 mb-2">ç®€ä»‹</h3><p class="text-white font-light mb-2">å¦‚æœä¸å…è®¸æ¨¡å—é—´ç›´æ¥ä¾èµ–ï¼Œä¸šåŠ¡äº¤äº’è¯¥å¦‚ä½•è¿›è¡Œï¼Ÿæœ¬æ–‡æ·±åº¦è§£æ Feature æ¨¡å—çš„ API ä¸ Internal è¾¹ç•Œè®¾è®¡ã€‚é€šè¿‡ç‰©ç†éš”ç¦»å°†â€œå¯¹å¤–çš„å¥‘çº¦â€ä¸â€œå†…éƒ¨çš„è„æ´»â€å½»åº•åˆ†å¼€ã€‚å®æˆ˜æ¼”ç¤ºå¦‚ä½•é€šè¿‡é¢†åŸŸæ¨¡å‹ï¼ˆDomain Modelï¼‰éš”ç¦»æ¡†æ¶æ±¡æŸ“ï¼Œåˆ©ç”¨æ¥å£å®šä¹‰èƒ½åŠ›ï¼Œå¹¶å€ŸåŠ©ä¾èµ–æ³¨å…¥å®ç°â€œé¢å‘æ¥å£ç¼–ç¨‹â€ï¼Œè®©ä¸šåŠ¡æ¨¡å—çœŸæ­£åƒç¬¬ä¸‰æ–¹åº“ä¸€æ ·ç‹¬ç«‹ä¸”ç¨³å¥ã€‚</p></div><!-- 2. å…³è”æ–‡ç«  --><div class="mb-4 rounded-xl bg-slate-700 p-5 shadow-xl border border-slate-600/50"><div class="mb-4 flex items-center justify-between border-b border-slate-600 pb-3"><div><h3 class="text-xs tracking-widest font-bold text-emerald-400 uppercase">
Series</h3><h2 class="text-base font-bold text-slate-100">åœ¨ Android ä¸­æ„å»ºå¯é•¿æœŸæ¼”åŒ–çš„ Feature æ¶æ„ï¼šä»æ¨¡å—è¾¹ç•Œåˆ°å•å‘æ•°æ®æµ</h2></div><span class="rounded-sm bg-slate-800 px-2 py-0.5 text-xs font-mono text-slate-300 border border-slate-600">3/5</span></div><div class="relative flex flex-col"><div class="absolute left-[7px] top-2 bottom-2 w-0.5 bg-slate-600 rounded-full"></div><a href="/blog/057931ede756/" class="group relative flex gap-4 py-2 transition-all items-center hover:pl-1"><div class="relative z-10 flex h-3.5 w-3.5 items-center justify-center"><div class="h-2.5 w-2.5 rounded-full bg-slate-500 group-hover:bg-slate-400 transition-colors"></div></div><div class="flex flex-col"><span class="text-sm leading-snug transition-colors text-slate-400 group-hover:text-slate-200">ä¸ºä»€ä¹ˆä½ çš„å¤šæ¨¡å—é¡¹ç›®ä¸€å®šä¼šäº’ç›¸æ±¡æŸ“</span></div></a><a href="/blog/45493f6eef9d/" class="group relative flex gap-4 py-2 transition-all items-center hover:pl-1"><div class="relative z-10 flex h-3.5 w-3.5 items-center justify-center"><div class="h-2.5 w-2.5 rounded-full bg-slate-500 group-hover:bg-slate-400 transition-colors"></div></div><div class="flex flex-col"><span class="text-sm leading-snug transition-colors text-slate-400 group-hover:text-slate-200">Core æ¨¡å—ä¸æ˜¯å·¥å…·ç®±ï¼šAndroid æ¶æ„é‡Œçš„â€œåœ°åŸºå±‚â€è¯¥æ”¾ä»€ä¹ˆ</span></div></a><a href="/blog/ea305ecafca7/" class="group relative flex gap-4 py-2 transition-all items-center pointer-events-none"><div class="relative z-10 flex h-3.5 w-3.5 items-center justify-center"><div class="h-3 w-3 rounded-full bg-blue-400 shadow-[0_0_8px_var(--color-blue-400)] ring-4 ring-blue-400/20"></div></div><div class="flex flex-col"><span class="text-sm leading-snug transition-colors font-bold text-blue-400">è®© Feature åƒç¬¬ä¸‰æ–¹åº“ä¸€æ ·è¢«ä½¿ç”¨ï¼šAPI ä¸ Internal çš„è¾¹ç•Œè®¾è®¡</span></div></a><a href="/blog/24a358bdbf05/" class="group relative flex gap-4 py-2 transition-all items-center hover:pl-1"><div class="relative z-10 flex h-3.5 w-3.5 items-center justify-center"><div class="h-3 w-3 rounded-full border-2 border-slate-500 bg-slate-700 group-hover:border-slate-300 transition-colors"></div></div><div class="flex flex-col"><span class="text-sm leading-snug transition-colors text-slate-300 group-hover:text-white">MVI åœ¨çœŸå®é¡¹ç›®ä¸­è¯¥æ€ä¹ˆè½åœ°ï¼šStateã€Intent ä¸ Effect çš„è¾¹ç•Œ</span></div></a><a href="/blog/435a921db46b/" class="group relative flex gap-4 py-2 transition-all items-center hover:pl-1"><div class="relative z-10 flex h-3.5 w-3.5 items-center justify-center"><div class="h-3 w-3 rounded-full border-2 border-slate-500 bg-slate-700 group-hover:border-slate-300 transition-colors"></div></div><div class="flex flex-col"><span class="text-sm leading-snug transition-colors text-slate-300 group-hover:text-white">å½“å¯¼èˆªå˜æˆçŠ¶æ€ï¼šå½»åº•æŠ›å¼ƒ NavController çš„çº¯ MVI å¯¼èˆª</span></div></a></div></div><!-- 3. éšæœºæ–‡ç«  --><div class="bg-slate-700 p-4 rounded-lg"><h3 class="text-emerald-400 mb-2">éšä¾¿çœ‹çœ‹</h3><div class="flex flex-wrap gap-2"><a class="px-3 py-1 bg-slate-600 rounded-full text-sm text-white hover:bg-emerald-500 transition" href="/blog/2abd28266885/">æµè§ˆå™¨ç«¯é€šè¿‡File Access APIéšè—ä¸‹è½½å®é™…é“¾æ¥çš„æ–¹æ³•</a><a class="px-3 py-1 bg-slate-600 rounded-full text-sm text-white hover:bg-emerald-500 transition" href="/blog/2b6de1fc1e65/">åŸºäºKotlinåç¨‹çš„é«˜æ•ˆå¼‚æ­¥æ–‡ä»¶ä¸Šä¼ æœåŠ¡è®¾è®¡ä¸å®ç°</a><a class="px-3 py-1 bg-slate-600 rounded-full text-sm text-white hover:bg-emerald-500 transition" href="/blog/66edd596bab7/">å‰ç«¯æ•°æ®å‹ç¼©ä¸è§£å‹ç¼©å®è·µæŒ‡å—</a></div></div></div></aside><main class="grow h-full overflow-auto w-3/4 px-8"><article class="text-zinc-200 mb-2 prose lg:prose-xl prose-stone
                 prose-headings:text-current prose-strong:text-current prose-code:text-current
                 prose-a:text-violet-200 prose-blockquote:text-stone-100"> <header> <h1>è®© Feature åƒç¬¬ä¸‰æ–¹åº“ä¸€æ ·è¢«ä½¿ç”¨ï¼šAPI ä¸ Internal çš„è¾¹ç•Œè®¾è®¡</h1> </header> <p>è¿™æ˜¯ç³»åˆ—æ–‡ç« çš„ç¬¬ä¸‰ç¯‡ã€‚</p>
<p>åœ¨å‰ä¸¤ç¯‡ä¸­ï¼Œæˆ‘ä»¬å»ºç«‹äº†â€œFeature äº’ä¸ä¾èµ–â€çš„ä¸–ç•Œè§‚ï¼Œå¹¶æŠŠ <code>core</code> æ¨¡å—å˜æˆäº†çº¯ç²¹çš„åŸºç¡€è®¾æ–½ã€‚ç°åœ¨ï¼Œæˆ‘ä»¬è¦è§£å†³æœ€æ£˜æ‰‹çš„é—®é¢˜ï¼š<strong>å¦‚æœä¸å…è®¸äº’ç›¸ä¾èµ–ï¼Œä¸šåŠ¡æ¨¡å—ä¹‹é—´åˆ°åº•æ€ä¹ˆäº¤äº’ï¼Ÿ</strong></p>
<p>æ¯”å¦‚ï¼Œ<code>feature:chat</code>ï¼ˆèŠå¤©ï¼‰æ¨¡å—éœ€è¦æ˜¾ç¤ºç”¨æˆ·çš„å¤´åƒå’Œæ˜µç§°ï¼Œæ•°æ®è‚¯å®šåœ¨ <code>feature:user</code>ï¼ˆç”¨æˆ·ï¼‰æ¨¡å—é‡Œã€‚</p>
<ul>
<li>âŒ <strong>é”™è¯¯åšæ³•</strong>ï¼šChat ç›´æ¥ä¾èµ– Userï¼Œè°ƒç”¨ <code>UserDb.dao.getUser()</code>ã€‚</li>
<li>âœ… <strong>æ­£ç¡®åšæ³•</strong>ï¼šChat ä¾èµ– User çš„ <strong>API</strong>ï¼ŒUser åœ¨ <strong>Internal</strong> é‡Œå®ç°é€»è¾‘ã€‚</li>
</ul>
<p>è¿™ä¸€ç¯‡ï¼Œæˆ‘ä»¬å°†æŠŠ Feature æ¨¡å—åˆ‡å¼€ï¼Œçœ‹çœ‹å®ƒè‚šå­é‡Œçš„ <strong>API</strong> å’Œ <strong>Internal</strong> åˆ°åº•è¯¥è£…ä»€ä¹ˆã€‚</p>
<hr>
<blockquote>
<p><strong>â€œFeature æ˜¯ä¸€ä¸ªç‹¬ç«‹å‘å¸ƒçš„äº§å“ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªä¸ºäº†åˆ†ç±»æ–‡ä»¶çš„æ–‡ä»¶å¤¹ã€‚â€</strong></p>
</blockquote>
<p>åœ¨ä¼ ç»Ÿçš„ MVVM æ¶æ„ä¸­ï¼Œæˆ‘ä»¬ä¹ æƒ¯æŒ‰â€œæŠ€æœ¯å±æ€§â€åˆ†åŒ…ï¼š<code>model</code>ã€<code>view</code>ã€<code>viewmodel</code>ã€‚
ä½†åœ¨ Clean Architecture + å¤šæ¨¡å—æ¶æ„ä¸­ï¼Œæˆ‘ä»¬å¿…é¡»æŒ‰â€œ<strong>å¯è§æ€§</strong>â€åˆ†åŒ…ã€‚</p>
<p>æƒ³è±¡ä¸€ä¸‹ä½ çš„ <code>feature:user</code> æ¨¡å—æ˜¯ä¸€ä¸ª<strong>å¾®æ³¢ç‚‰</strong>ã€‚</p>
<ul>
<li><strong>API (å¤–éƒ¨å¯è§)</strong>ï¼šæŒ‰é’®ã€æ˜¾ç¤ºå±ã€ç”µæºæ’å¤´ã€‚ç”¨æˆ·ï¼ˆå…¶ä»–æ¨¡å—ï¼‰åªèƒ½æ¥è§¦è¿™äº›ã€‚</li>
<li><strong>Internal (å¤–éƒ¨ä¸å¯è§)</strong>ï¼šç£æ§ç®¡ã€å˜å‹å™¨ã€ç”µè·¯æ¿ã€‚ç”¨æˆ·ä¸éœ€è¦çœ‹ï¼Œä¹Ÿä¸å…è®¸æ‘¸ï¼Œå¦åˆ™ä¼šè§¦ç”µã€‚</li>
</ul>
<h2 id="ä¸€-ç‰©ç†ç»“æ„å¼ºåˆ¶æ€§çš„éš”ç¦»">ä¸€ã€ ç‰©ç†ç»“æ„ï¼šå¼ºåˆ¶æ€§çš„éš”ç¦»</h2>
<p>ä¸ºäº†åœ¨ç‰©ç†ä¸Šå¼ºåˆ¶æ‰§è¡Œè¿™ä¸ªè§„åˆ™ï¼Œä½ çš„ Feature æ¨¡å—æ–‡ä»¶ç»“æ„åº”è¯¥é•¿è¿™æ ·ï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="text"><code><span class="line"><span>feature/user/</span></span>
<span class="line"><span>â”œâ”€â”€ api/                  &#x3C;-- ã€æ©±çª—ã€‘å…¶ä»–æ¨¡å—å¯è§</span></span>
<span class="line"><span>â”‚   â”œâ”€â”€ model/            &#x3C;-- çº¯å‡€çš„é¢†åŸŸæ¨¡å‹</span></span>
<span class="line"><span>â”‚   â”œâ”€â”€ UserRepository.kt &#x3C;-- æ¥å£å®šä¹‰</span></span>
<span class="line"><span>â”‚   â”œâ”€â”€ UserGraph.kt      &#x3C;-- å¯¼èˆªå…¥å£</span></span>
<span class="line"><span>â”‚   â””â”€â”€ UserModuleDI.kt   &#x3C;-- ä¾èµ–æ³¨å…¥èšåˆç‚¹</span></span>
<span class="line"><span>â””â”€â”€ internal/             &#x3C;-- ã€å·¥å‚ã€‘å¯¹å¤–éƒ¨éšè—</span></span>
<span class="line"><span>    â”œâ”€â”€ data/             &#x3C;-- æ•°æ®åº“ã€ç½‘ç»œã€DTO</span></span>
<span class="line"><span>    â”œâ”€â”€ presentation/     &#x3C;-- MVIã€ViewModelã€Compose Screen</span></span>
<span class="line"><span>    â””â”€â”€ di/               &#x3C;-- å†…éƒ¨ä¾èµ–æ³¨å…¥ç»‘å®š</span></span></code></pre>
<p>åœ¨ Gradle å±‚é¢ï¼ˆå¦‚æœä½ ä½¿ç”¨äº†å¤åˆæ„å»ºæˆ– API æ¨¡å—åˆ†ç¦»ï¼‰ï¼Œå…¶ä»–æ¨¡å—åªèƒ½ <code>implementation project(":feature:user:api")</code>ï¼Œæ ¹æœ¬æ— æ³•è®¿é—® <code>internal</code> çš„ä»£ç ã€‚</p>
<p>å³ä½¿åœ¨åŒä¸€ä¸ª Gradle æ¨¡å—å†…ï¼Œä½ ä¹Ÿåº”è¯¥åˆ©ç”¨ Kotlin çš„ <code>internal</code> å…³é”®å­—è¿›è¡Œä¸¥æ ¼é™åˆ¶ã€‚</p>
<h2 id="äºŒ-api-å±‚çœŸæ­£çš„å¥‘çº¦">äºŒã€ API å±‚ï¼šçœŸæ­£çš„â€œå¥‘çº¦â€</h2>
<p>API å±‚æ˜¯è¯¥æ¨¡å—å¯¹å¤–å”¯ä¸€çš„æ‰¿è¯ºã€‚ä¸€æ—¦å‘å¸ƒï¼Œå°½é‡å°‘æ”¹ã€‚</p>
<h3 id="1-modelæ˜¯é¢†åŸŸè¯­è¨€ä¸æ˜¯-dto">1. Modelï¼šæ˜¯é¢†åŸŸè¯­è¨€ï¼Œä¸æ˜¯ DTO</h3>
<p>è¿™æ˜¯åˆå­¦è€…æœ€å®¹æ˜“æ··æ·†çš„åœ°æ–¹ã€‚API é‡Œçš„ <code>User</code> å¯¹è±¡ï¼Œå’ŒæœåŠ¡å™¨è¿”å›çš„ JSONï¼Œæˆ–è€…æ•°æ®åº“é‡Œçš„ Entityï¼Œ<strong>ç»å¯¹ä¸èƒ½æ˜¯åŒä¸€ä¸ªç±»</strong>ã€‚</p>
<p><strong><code>api/model/User.kt</code> (é¢†åŸŸæ¨¡å‹)</strong></p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="kotlin"><code><span class="line"><span style="color:#F97583">data</span><span style="color:#F97583"> class</span><span style="color:#B392F0"> User</span><span style="color:#E1E4E8">(</span></span>
<span class="line"><span style="color:#F97583">    val</span><span style="color:#E1E4E8"> id: </span><span style="color:#B392F0">Long</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#F97583">    val</span><span style="color:#E1E4E8"> name: </span><span style="color:#B392F0">String</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#F97583">    val</span><span style="color:#E1E4E8"> avatarUrl: </span><span style="color:#B392F0">String</span><span style="color:#E1E4E8">?</span></span>
<span class="line"><span style="color:#E1E4E8">)</span></span></code></pre>
<p>æ³¨æ„ï¼šå®ƒæ˜¯çº¯ç²¹çš„ Kotlin ç±»ã€‚æ²¡æœ‰ <code>@SerializedName</code> (Gson/Moshi)ï¼Œæ²¡æœ‰ <code>@Entity</code> (Room)ï¼Œæ²¡æœ‰ <code>@Parcelize</code> (Android)ã€‚å®ƒ<strong>æ²¡æœ‰ä»»ä½•æ¡†æ¶ä¾èµ–</strong>ã€‚</p>
<p>ä¸ºä»€ä¹ˆï¼Ÿå› ä¸ºå¦‚æœä½ çš„ API Model ä¾èµ–äº† Room æ³¨è§£ï¼Œæ‰€æœ‰ä½¿ç”¨è¿™ä¸ª API çš„æ¨¡å—ï¼ˆæ¯”å¦‚ Chat æ¨¡å—ï¼‰éƒ½è¢«è¿«ä¾èµ–äº† Roomã€‚è¿™å°±å«<strong>æ±¡æŸ“</strong>ã€‚</p>
<h3 id="2-repository-interfaceå®šä¹‰èƒ½åŠ›">2. Repository Interfaceï¼šå®šä¹‰èƒ½åŠ›</h3>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="kotlin"><code><span class="line"><span style="color:#6A737D">// api/UserRepository.kt</span></span>
<span class="line"><span style="color:#F97583">interface</span><span style="color:#B392F0"> UserRepository</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#F97583">    suspend</span><span style="color:#F97583"> fun</span><span style="color:#B392F0"> getUserInfo</span><span style="color:#E1E4E8">(id: </span><span style="color:#B392F0">Long</span><span style="color:#E1E4E8">): </span><span style="color:#B392F0">User</span><span style="color:#E1E4E8">?</span></span>
<span class="line"><span style="color:#E1E4E8">}</span></span></code></pre>
<p>è¿™é‡Œåªå®šä¹‰<strong>æ¥å£</strong>ã€‚
<code>feature:chat</code> æ‹¿åˆ°è¿™ä¸ªæ¥å£ï¼Œå°±èƒ½å†™ä»£ç äº†ï¼šâ€œæˆ‘è¦è°ƒ <code>getUserInfo</code>â€ã€‚è‡³äºä½ æ˜¯ä» HTTP æ‹¿çš„ï¼Œè¿˜æ˜¯ä» SQLite æ‹¿çš„ï¼ŒChat æ¨¡å—å®Œå…¨ä¸åœ¨ä¹ã€‚</p>
<h3 id="3-navigationæŠŠè·¯ç”±æš´éœ²å‡ºå»">3. Navigationï¼šæŠŠè·¯ç”±æš´éœ²å‡ºå»</h3>
<p>ç»“åˆä¸Šä¸€ç¯‡çš„ <code>Screen</code> æ¥å£ï¼Œæˆ‘ä»¬éœ€è¦æŠŠè¯¥æ¨¡å—çš„å…¥å£æš´éœ²å‡ºæ¥ã€‚</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="kotlin"><code><span class="line"><span style="color:#6A737D">// core/navigation/UserRoute.kt</span></span>
<span class="line"><span style="color:#6A737D">// å®šä¹‰è·³è½¬ç›®æ ‡</span></span>
<span class="line"><span style="color:#B392F0">@Serializable</span></span>
<span class="line"><span style="color:#F97583">data</span><span style="color:#F97583"> class</span><span style="color:#B392F0"> UserDetailScreen</span><span style="color:#E1E4E8">(</span><span style="color:#F97583">val</span><span style="color:#E1E4E8"> userId: </span><span style="color:#B392F0">Long</span><span style="color:#E1E4E8">) : </span><span style="color:#B392F0">UserScreenRoot</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D">// user/api/UserGraph.kt</span></span>
<span class="line"><span style="color:#6A737D">// å®šä¹‰å¯¼èˆªå›¾æ„å»ºé€»è¾‘ (æš´éœ²ç»™ App å£³ä½¿ç”¨)</span></span>
<span class="line"><span style="color:#F97583">fun</span><span style="color:#B392F0"> NavGraphBuilder</span><span style="color:#E1E4E8">.</span><span style="color:#B392F0">userGraph</span><span style="color:#E1E4E8">() {</span></span>
<span class="line"><span style="color:#B392F0">    composable</span><span style="color:#E1E4E8">&#x3C;</span><span style="color:#B392F0">UserDetailScreen</span><span style="color:#E1E4E8">> { </span><span style="color:#F97583">..</span><span style="color:#E1E4E8">. }</span></span>
<span class="line"><span style="color:#E1E4E8">}</span></span></code></pre>
<h3 id="4-di-moduleæ’å¤´">4. DI Moduleï¼šæ’å¤´</h3>
<p>æœ€åï¼Œä½ éœ€è¦æä¾›ä¸€ä¸ª Koin/Hilt æ¨¡å—ï¼ŒæŠŠè¿™äº›ä¸œè¥¿æ‰“åŒ…ã€‚</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="kotlin"><code><span class="line"><span style="color:#6A737D">// api/UserModule.kt</span></span>
<span class="line"><span style="color:#F97583">val</span><span style="color:#E1E4E8"> userModule </span><span style="color:#F97583">=</span><span style="color:#B392F0"> module</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#6A737D">    // åŒ…å«å†…éƒ¨çš„å®ç°ï¼Œå¯¹å¤–åªæš´éœ²è¿™ä¸€ä¸ª val</span></span>
<span class="line"><span style="color:#B392F0">    includes</span><span style="color:#E1E4E8">(internalUserModule)</span></span>
<span class="line"><span style="color:#E1E4E8">}</span></span></code></pre>
<h2 id="ä¸‰-internal-å±‚è‚®è„çš„ç°å®">ä¸‰ã€ Internal å±‚ï¼šè‚®è„çš„ç°å®</h2>
<p>API å±‚åƒç«¥è¯ä¸€æ ·ç¾å¥½ï¼ŒInternal å±‚åˆ™æ˜¯ç°å®ä¸–ç•Œçš„â€œä¸‹æ°´é“â€ã€‚æ‰€æœ‰çš„æ¡†æ¶ä¾èµ–ã€å¤æ‚çš„é€»è¾‘ã€MVI çŠ¶æ€ç®¡ç†ï¼Œéƒ½å°è£…åœ¨è¿™é‡Œã€‚</p>
<h3 id="1-data-layerè„æ´»ç´¯æ´»">1. Data Layerï¼šè„æ´»ç´¯æ´»</h3>
<p>è¿™é‡Œæœ‰ <code>UserEntity</code> (Room) å’Œ <code>UserDto</code> (Network)ã€‚
<strong>å¿…é¡»å­˜åœ¨ä¸€ä¸ª Mapper</strong>ï¼Œè´Ÿè´£æŠŠè„æ•°æ®è½¬åŒ–ä¸ºå¹²å‡€çš„ API <code>User</code> å¯¹è±¡ã€‚</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="kotlin"><code><span class="line"><span style="color:#6A737D">// internal/data/mapper/UserMapper.kt</span></span>
<span class="line"><span style="color:#F97583">internal</span><span style="color:#F97583"> fun</span><span style="color:#B392F0"> UserDto</span><span style="color:#E1E4E8">.</span><span style="color:#B392F0">toDomain</span><span style="color:#E1E4E8">(): </span><span style="color:#B392F0">User</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#F97583">    return</span><span style="color:#B392F0"> User</span><span style="color:#E1E4E8">(</span></span>
<span class="line"><span style="color:#E1E4E8">        id </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> this</span><span style="color:#E1E4E8">.id,</span></span>
<span class="line"><span style="color:#E1E4E8">        name </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> this</span><span style="color:#E1E4E8">.nickname ?: </span><span style="color:#9ECBFF">"Unknown"</span><span style="color:#E1E4E8">, </span><span style="color:#6A737D">// å¤„ç†è„æ•°æ®</span></span>
<span class="line"><span style="color:#E1E4E8">        avatarUrl </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> this</span><span style="color:#E1E4E8">.avatar</span></span>
<span class="line"><span style="color:#E1E4E8">    )</span></span>
<span class="line"><span style="color:#E1E4E8">}</span></span></code></pre>
<p>è¿™å°±æ˜¯æ¶æ„çš„â€œç¨â€ï¼šä½ éœ€è¦å¤šå†™æ ·æ¿ä»£ç ã€‚ä½†è¿™ä¸ªç¨äº¤å¾—å€¼ï¼Œå› ä¸ºå®ƒæ¢æ¥äº†<strong>éš”ç¦»æ€§</strong>ã€‚å“ªæ€•åç«¯æŠŠå­—æ®µåä» <code>nickname</code> æ”¹æˆäº† <code>display_name</code>ï¼Œä½ åªéœ€è¦æ”¹ <code>internal</code> é‡Œçš„ Mapperï¼Œå¤–é¢çš„ <code>Chat</code> æ¨¡å—å®Œå…¨æ— æ„ŸçŸ¥ï¼Œä¸ç”¨é‡æ–°ç¼–è¯‘ã€‚</p>
<h3 id="2-implementationé—­ç¯">2. Implementationï¼šé—­ç¯</h3>
<p>è¿™é‡Œå®ç° API æ¥å£ã€‚</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="kotlin"><code><span class="line"><span style="color:#6A737D">// internal/data/repo/UserRepositoryImpl.kt</span></span>
<span class="line"><span style="color:#F97583">internal</span><span style="color:#F97583"> class</span><span style="color:#B392F0"> UserRepositoryImpl</span><span style="color:#E1E4E8">(</span></span>
<span class="line"><span style="color:#F97583">    private</span><span style="color:#F97583"> val</span><span style="color:#E1E4E8"> api: </span><span style="color:#B392F0">UserApi</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#F97583">    private</span><span style="color:#F97583"> val</span><span style="color:#E1E4E8"> dao: </span><span style="color:#B392F0">UserDao</span></span>
<span class="line"><span style="color:#E1E4E8">) : </span><span style="color:#B392F0">UserRepository</span><span style="color:#E1E4E8"> { </span><span style="color:#6A737D">// å®ç° API æ¥å£</span></span>
<span class="line"><span style="color:#F97583">    override</span><span style="color:#F97583"> suspend</span><span style="color:#F97583"> fun</span><span style="color:#B392F0"> getUserInfo</span><span style="color:#E1E4E8">(id: </span><span style="color:#B392F0">Long</span><span style="color:#E1E4E8">): </span><span style="color:#B392F0">User</span><span style="color:#E1E4E8">? {</span></span>
<span class="line"><span style="color:#6A737D">        // ç¼“å­˜ç­–ç•¥ã€ç½‘ç»œè¯·æ±‚ã€è½¬æ¢é€»è¾‘éƒ½åœ¨è¿™</span></span>
<span class="line"><span style="color:#F97583">        val</span><span style="color:#E1E4E8"> entity </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> dao.</span><span style="color:#B392F0">getUser</span><span style="color:#E1E4E8">(id)</span></span>
<span class="line"><span style="color:#F97583">        return</span><span style="color:#E1E4E8"> entity?.</span><span style="color:#B392F0">toDomain</span><span style="color:#E1E4E8">()</span></span>
<span class="line"><span style="color:#E1E4E8">    }</span></span>
<span class="line"><span style="color:#E1E4E8">}</span></span></code></pre>
<p>æ³¨æ„ <code>internal</code> å…³é”®å­—ã€‚å¤–éƒ¨æ²¡æœ‰ä»»ä½•äººèƒ½ <code>UserRepositoryImpl()</code>ã€‚å®ƒä»¬å¿…é¡»é€šè¿‡ä¾èµ–æ³¨å…¥è·å–ã€‚</p>
<h3 id="3-presentationui-æ˜¯ç§æœ‰çš„">3. Presentationï¼šUI æ˜¯ç§æœ‰çš„</h3>
<p>ä½ å¯èƒ½å¾ˆæƒŠè®¶ï¼š<strong>UI (Compose Screen) ä¹Ÿæ˜¯ Internal çš„å—ï¼Ÿ</strong></p>
<p>æ˜¯çš„ã€‚
é™¤äº†æå°‘æ•°é€šç”¨ç»„ä»¶ï¼ˆåœ¨ Core ä¸­ï¼‰ï¼Œä¸šåŠ¡ UI éƒ½æ˜¯ç§æœ‰çš„ã€‚
å…¶ä»–æ¨¡å—ä¸éœ€è¦ç›´æ¥å¼•ç”¨ <code>UserDetailScreen</code> çš„ Composable å‡½æ•°ï¼Œå®ƒä»¬åªéœ€è¦é€šè¿‡ Router å¯¼èˆªåˆ° <code>UserDetailScreen</code> è¿™ä¸ª <strong>Data Class</strong> å³å¯ã€‚</p>
<h3 id="4-domain-layerä¸šåŠ¡é€»è¾‘çš„å‡€åœŸ">4. Domain Layerï¼šä¸šåŠ¡é€»è¾‘çš„å‡€åœŸ</h3>
<p>å¦‚æœä½ çš„ä¸šåŠ¡é€»è¾‘éå¸¸å¤æ‚ï¼ˆæ¯”å¦‚å¤æ‚çš„é‡‘èè®¡ç®—ã€å¤šæ•°æ®æºåˆå¹¶ï¼‰ï¼Œä½ å¯èƒ½ä¸å¸Œæœ› <code>Executor</code> ç›´æ¥å’Œ <code>Repository</code> å¯¹è¯ã€‚è¿™æ—¶ï¼Œä½ å¯ä»¥åœ¨ <code>internal</code> ä¸‹å†åˆ†å‡ºä¸€ä¸ª <code>domain</code> åŒ…ã€‚</p>
<ul>
<li><strong>UseCase</strong>ï¼š<code>GetValidUserUseCase</code>ã€‚å®ƒè´Ÿè´£ç¼–æ’ä¸šåŠ¡é€»è¾‘ã€‚</li>
<li><strong>DomainModule</strong>ï¼šè´Ÿè´£æŠŠ UseCase æ³¨å…¥åˆ° Koin ä¸­ã€‚</li>
</ul>
<p><strong>ä½†åœ¨æœ¬æ¶æ„ä¸­ï¼ŒUseCase æ˜¯å®Œå…¨ç§æœ‰çš„ï¼ˆInternalï¼‰ã€‚</strong>
å¤–éƒ¨æ¨¡å—æ ¹æœ¬ä¸éœ€è¦çŸ¥é“ä½ ç”¨äº† UseCase è¿˜æ˜¯ç›´æ¥è°ƒäº† Repoï¼Œè¿™æ˜¯ä½ çš„å†…éƒ¨å®ç°ç»†èŠ‚ã€‚</p>
<h2 id="å››-ä¾èµ–æ³¨å…¥å°†ä¸¤è€…ç¼åˆ">å››ã€ ä¾èµ–æ³¨å…¥ï¼šå°†ä¸¤è€…ç¼åˆ</h2>
<p>æ—¢ç„¶ <code>UserRepositoryImpl</code> æ˜¯ hidden çš„ï¼Œå…¶ä»–æ¨¡å—æ€ä¹ˆæ‹¿åˆ°å®ƒå‘¢ï¼Ÿ
è¿™å°±è½®åˆ° <strong>App å£³å·¥ç¨‹</strong> å’Œ <strong>DI</strong> å‡ºåœºäº†ã€‚</p>
<p>åœ¨ <code>internal/di/InternalUserModule.kt</code> ä¸­ï¼Œæˆ‘ä»¬åšç»‘å®šï¼š</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="kotlin"><code><span class="line"><span style="color:#F97583">internal</span><span style="color:#F97583"> val</span><span style="color:#E1E4E8"> internalUserDateModule </span><span style="color:#F97583">=</span><span style="color:#B392F0"> module</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#6A737D">    // å‘Šè¯‰ Koinï¼šå½“æœ‰äººè¦ UserRepository æ—¶ï¼Œç»™ä»– UserRepositoryImpl</span></span>
<span class="line"><span style="color:#B392F0">    singleOf</span><span style="color:#E1E4E8">(::</span><span style="color:#B392F0">UserRepositoryImpl</span><span style="color:#E1E4E8">) bind UserRepository::</span><span style="color:#B392F0">class</span></span>
<span class="line"><span style="color:#6A737D">    // å¦‚æœ UserRepository ä¸­æœ‰ä¸€äº›ä¸æƒ³æš´éœ²ç»™å…¶ä»–æ¨¡å—çš„æŸ¥è¯¢æ–¹æ³•</span></span>
<span class="line"><span style="color:#B392F0">    singleOf</span><span style="color:#E1E4E8">(::</span><span style="color:#B392F0">UserRepositoryImpl</span><span style="color:#E1E4E8">) binds </span><span style="color:#B392F0">arrayOf</span><span style="color:#E1E4E8">(</span></span>
<span class="line"><span style="color:#E1E4E8">        UserRepository::</span><span style="color:#B392F0">class</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#E1E4E8">        InternalUserRepository::</span><span style="color:#B392F0">class</span></span>
<span class="line"><span style="color:#E1E4E8">    )</span></span>
<span class="line"><span style="color:#E1E4E8">}</span></span></code></pre>
<p>å½“ <code>app</code> æ¨¡å—å¯åŠ¨æ—¶ï¼Œå®ƒåŠ è½½äº† <code>userModule</code>ã€‚
å½“ <code>feature:chat</code> è¿è¡Œæ—¶ï¼Œå®ƒå‘ Koin ä¼¸æ‰‹è¦ <code>get&#x3C;UserRepository>()</code>ã€‚
Koin å·å·æŠŠ <code>internal</code> é‡Œçš„ <code>UserRepositoryImpl</code> å¡ç»™äº†å®ƒã€‚</p>
<p>è¿™å°±æ˜¯ <strong>ä¾èµ–å€’ç½®åŸåˆ™ (DIP)</strong> çš„ç»ˆæä½“ç°ã€‚</p>
<h2 id="äº”-æ€»ç»“">äº”ã€ æ€»ç»“</h2>
<p>è¿™ä¸€ç¯‡æ˜¯æ¶æ„çš„â€œéª¨æ¶â€ã€‚é€šè¿‡ä¸¥æ ¼åŒºåˆ† <strong>API</strong> å’Œ <strong>Internal</strong>ï¼š</p>
<ol>
<li><strong>è§£è€¦</strong>ï¼šDomain Model ä¸å«æ¡†æ¶æ³¨è§£ï¼Œä¸šåŠ¡é€»è¾‘çº¯å‡€ã€‚</li>
<li><strong>éšè—</strong>ï¼šå¤æ‚çš„ MVIã€æ•°æ®åº“å®ç°å¯¹å¤–éƒ¨ä¸å¯è§ï¼Œé‡æ„å†…éƒ¨é€»è¾‘é›¶é£é™©ã€‚</li>
<li><strong>åä½œ</strong>ï¼šæ¨¡å—é—´é€šè¿‡ Interface äº¤äº’ï¼Œç¼–è¯‘é€Ÿåº¦å¿«ï¼Œè´£ä»»åˆ’åˆ†æ¸…æ™°ã€‚</li>
</ol>
<p>ç°åœ¨ï¼Œæˆ‘ä»¬æŠŠ Feature çš„å¤–è§‚ï¼ˆAPIï¼‰å’Œç»“æ„ï¼ˆInternalï¼‰éƒ½æ­å¥½äº†ã€‚
ä½†æ˜¯ï¼ŒInternal å†…éƒ¨çš„ UI é€»è¾‘è¯¥æ€ä¹ˆå†™ï¼Ÿå¦‚ä½•è®© UI å“åº”å˜å¾—å¯é¢„æµ‹ï¼Ÿå¦‚ä½•é¿å… ViewModel è†¨èƒ€ï¼Ÿ</p>
<p>ä¸‹ä¸€ç¯‡ï¼Œæˆ‘ä»¬å°†è¿›å…¥è¿™ä¸€å¥—æ¶æ„çš„â€œå¿ƒè„â€ â€”â€” <strong>MVI æ¨¡å¼</strong>ã€‚æˆ‘ä»¬å°†è§£é‡Šä¸ºä»€ä¹ˆåœ¨å¤šæ¨¡å— + Compose çš„ä¸–ç•Œé‡Œï¼ŒMVVM å·²ç»ä¸å¤Ÿç”¨äº†ã€‚</p>
<p><strong>ä¸‹ä¸€ç¯‡ï¼š<a href="/blog/24a358bdbf05/">ã€ŠMVI åœ¨çœŸå®é¡¹ç›®ä¸­è¯¥æ€ä¹ˆè½åœ°ï¼šStateã€Intent ä¸ Effect çš„è¾¹ç•Œã€‹</a></strong></p> </article><div class="tags"><div class="_tailmateTag_u5zwa_5"><a href="/blog/tag/è½¯ä»¶æ¶æ„/">è½¯ä»¶æ¶æ„</a></div><div class="_tailmateTag_u5zwa_5"><a href="/blog/tag/Android/">Android</a></div><div class="_tailmateTag_u5zwa_5"><a href="/blog/tag/Kotlin/">Kotlin</a></div><div class="_tailmateTag_u5zwa_5"><a href="/blog/tag/JVM/">JVM</a></div><div class="_tailmateTag_u5zwa_5"><a href="/blog/tag/æ•°æ®ç®¡ç†/">æ•°æ®ç®¡ç†</a></div><div class="_tailmateTag_u5zwa_5"><a href="/blog/tag/å†…å­˜ç®¡ç†/">å†…å­˜ç®¡ç†</a></div><div class="_tailmateTag_u5zwa_5"><a href="/blog/tag/åç«¯è®¾è®¡/">åç«¯è®¾è®¡</a></div></div></main></div><div class="okTgGW_footer"> <p>Supported and developed by&nbsp;
<a href="https://github.com/misakamayako/" target="_blank" rel="noreferrer">misaka mayako</a> </p> <p>
Tech with <a href="https://astro.build/" target="_blank" rel="noreferrer">astro</a>,&nbsp;
<a href="https://tailwindcss.com/" target="_blank" rel="noreferrer">tailwindcss</a>,&nbsp;
        and <a href="https://pm2.keymetrics.io/" target="_blank" rel="noreferrer">pm2</a>,&nbsp;
</p> <p> feed back via <a href="mailto:misakamayaco@qq.com" target="_blank" rel="noreferrer">ğŸ“«</a></p> <a rel="license noreferrer" href="https://creativecommons.org/licenses/by-sa/4.0/" target="_blank" class="absolute right-6 bottom-6"> <img alt="çŸ¥è¯†å…±äº«è®¸å¯åè®®" class="inlin-block border-0" src="/cc4.0.png"> </a> </div></div><script type="module" is:global>
        document.addEventListener('DOMContentLoaded', () => {
            document.querySelectorAll('pre').forEach((block) => {
                if (block.dataset.language === 'plaintext') return
                const button = document.createElement('button')
                button.innerText = 'å¤åˆ¶'
                button.className =
                    'absolute top-2 right-2 bg-slate-800 text-white px-2 py-1 rounded text-sm opacity-50 hover:opacity-100 transition cursor-pointer'
                button.addEventListener('click', () => {
                    const code = block.querySelector('code')
                    if (code) {
                        navigator.clipboard.writeText(code.innerText).then(() => {
                            button.innerText = 'å·²å¤åˆ¶ï¼'
                            setTimeout(() => (button.innerText = 'å¤åˆ¶'), 1000)
                        })
                    }
                })
                block.classList.add('relative')
                block.appendChild(button)
            })
        })
    </script> </body></html>